"'Date Picker' As CanvasComponent":
    CalendarVisibility: =varCalendarVis
    DateSelected: =DP_Label.Text
    Fill: =RGBA(0, 0, 0, 0)
    Height: =If(Self.CalendarVisibility = true, 640, 70)
    IconLinealGradient1: |-
        ="#2c3e50"
    IconLinealGradient2: |-
        ="#3498db"
    Width: =If(Self.CalendarVisibility = true, 640, 350)
    X: =0
    Y: =0
    ZIndex: =2

    DP_HTML As htmlViewer:
        Height: =84
        HtmlText: |-
            ="<div
                style='
                    margin:10px;
                    width: "& Self.Width - 40 &"px;
                    height: "& Self.Height - 40 &"px;
                    background: #e8eaec;
                    box-shadow: 6px 6px 8px rgba(13, 39, 80, 0.25), -6px -6px 6px white, inset -8px -8px 12px rgba(255, 255, 255, 0.7), inset 5px 5px 8px rgba(13, 39, 80, 0.2);
                    border-radius:10px'>
            </div>"
        Width: =265
        X: =18
        ZIndex: =7

    DP_Image As image:
        Height: =29
        Image: |-
            ="data:image/svg+xml;
                utf8,
                    "&EncodeUrl("
                        <svg
                            xmlns='http://www.w3.org/2000/svg'
                            width='16'
                            height='16' 
                            fill='currentColor' 
                            class='bi bi-calendar'
                            viewBox='0 0 16 16'
                        >
                            <defs>  
                                <linearGradient id='gradient' x1='0%' y1='0%' x2='0%' y2='100%'>  
                                    <stop offset='15%' style='stop-color: "& Parent.IconLinealGradient1 &" ;'></stop>  
                                    <stop offset='100%' style='stop-color: "& Parent.IconLinealGradient2 &" ;'></stop>  
                                </linearGradient>  
                            </defs>
            
                            <path 
                                fill='url(#gradient)' d='M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4H1z'
                            />
                        </svg>
                    ")
        Width: =25
        X: =47
        Y: =22
        ZIndex: =8

    DP_Label As label:
        Color: =RGBA(82, 82, 82, 1)
        Height: =45
        Text: =Text(_dateSelected, DateTimeFormat.ShortDate)
        X: =83
        Y: =14
        ZIndex: =9

    DP_Button As button:
        BorderThickness: =0
        Fill: =RGBA(0, 0, 0, 0)
        Height: =42
        HoverFill: =RGBA(196, 196, 196, 0.2)
        OnSelect: |-
            =/*resets calendar view and date selection to today*/
            Set(
                _firstDayOfMonth,
                DateAdd(
                    Today(),
                    1 - Day(Today()),
                    TimeUnit.Days
                )
            );
            Set(
                _firstDayInView,
                DateAdd(
                    _firstDayOfMonth,
                    -(Weekday(_firstDayOfMonth) - 2 + 1),
                    TimeUnit.Days
                )
            );
            Set(
                _lastDayOfMonth,
                DateAdd(
                    DateAdd(
                        _firstDayOfMonth,
                        1,
                        TimeUnit.Months
                    ),
                    -1,
                    TimeUnit.Days
                )
            );
            
            Set(varCalendarVis, !varCalendarVis)
        PressedFill: =RGBA(196, 196, 196, 0.4)
        Size: =24
        Text: =""
        Width: =224
        X: =34
        Y: =17
        ZIndex: =10

    Calenders As group:
        Height: =5
        Width: =5
        X: =100
        Y: =100
        ZIndex: =11

        Calender_HTML As htmlViewer:
            Height: =557
            HtmlText: |-
                ="<div
                    style='
                        margin:30px;
                        width: "& Self.Width - 80 &"px;
                        height: "& Self.Height - 80 &"px;
                        background: #e8eaec;
                        box-shadow: 12px 12px 32px rgba(13, 39, 80, 0.25), -10px -10px 15px white, inset -15px -15px 20px rgba(255, 255, 255, 0.7), inset 8px 8px 20px rgba(13, 39, 80, 0.2);
                        border-radius:25px'
                >
                </div>"
            Visible: =varCalendarVis
            Width: =640
            Y: =43
            ZIndex: =1

        CurrentDayLabel As label:
            Align: =Align.Center
            BorderColor: =RGBA(0, 0, 0, 1)
            Color: =RGBA(87, 87, 87, 1)
            Font: =Font.'Segoe UI'
            Height: =50
            Size: =14
            Text: =Text(_firstDayOfMonth, "mmmm yyyy")
            Visible: =varCalendarVis
            Width: =419
            Wrap: =false
            X: =106
            Y: =82
            ZIndex: =2

        "Previous As icon.'3DPrinting'":
            Color: =ColorValue( 'Date Picker'.IconLinealGradient1 )
            Height: =50
            HoverColor: =ColorValue( 'Date Picker'.IconLinealGradient2)
            Icon: =Icon.ChevronLeft
            OnSelect: |
                =/*changes month view to previous month*/
                Set(_firstDayOfMonth, DateAdd(_firstDayOfMonth, -1, TimeUnit.Months));
                Set(_firstDayInView, DateAdd(_firstDayOfMonth, -(Weekday(_firstDayOfMonth) - 2 + 1), TimeUnit.Days));
                Set(_lastDayOfMonth, DateAdd(DateAdd(_firstDayOfMonth, 1, TimeUnit.Months), -1, TimeUnit.Days));
            PaddingBottom: =7
            PaddingLeft: =7
            PaddingRight: =7
            PaddingTop: =7
            TabIndex: =0
            Tooltip: ="View previous month"
            Visible: =varCalendarVis
            Width: =50
            X: =62
            Y: =84
            ZIndex: =3

        "Next As icon.'3DPrinting'":
            Color: =ColorValue( 'Date Picker'.IconLinealGradient1 )
            Height: =50
            Icon: =Icon.ChevronRight
            OnSelect: |-
                =/*changes month view to next month*/
                Set(_firstDayOfMonth, DateAdd(_firstDayOfMonth, 1, TimeUnit.Months));
                Set(_firstDayInView, DateAdd(_firstDayOfMonth, -(Weekday(_firstDayOfMonth) - 2 + 1), TimeUnit.Days));
                /*collects calendar events for all days in current month view. Updates _maxDate to prevent duplicate data collection if user returns to this month view*/
                Set(_lastDayOfMonth, DateAdd(DateAdd(_firstDayOfMonth, 1, TimeUnit.Months), -1, TimeUnit.Days));
                Set(_maxDate, _lastDayOfMonth); 
            PaddingBottom: =7
            PaddingLeft: =7
            PaddingRight: =7
            PaddingTop: =7
            TabIndex: =0
            Tooltip: ="View next month"
            Visible: =varCalendarVis
            Width: =50
            X: =525
            Y: =84
            ZIndex: =4

        "WeekdayGallery As gallery.'BrowseLayout_Horizontal_TwoTextOneImageVariant_ver4.0'":
            DelayItemLoading: =true
            Height: =45
            Items: =Calendar.WeekdaysShort()
            LoadingSpinner: =LoadingSpinner.Data
            ShowScrollbar: =false
            TemplatePadding: =0
            TemplateSize: =60
            Visible: =varCalendarVis
            Width: =420
            X: =112
            Y: =122
            ZIndex: =5

            WDG_Label As label:
                Align: =Align.Center
                Color: =RGBA(71, 71, 71, 1)
                Font: =Font.'Lato Black'
                FontWeight: =FontWeight.Normal
                Height: =WeekdayGallery.TemplateHeight
                OnSelect: =Select(Parent)
                Size: =17 * WeekdayGallery.TemplateWidth /85
                Text: =ThisItem.Value
                Width: =WeekdayGallery.TemplateWidth
                Wrap: =false
                X: =WeekdayGallery.TemplateWidth / 2 - Self.Width / 2
                Y: =WeekdayGallery.TemplateHeight / 2 - Self.Height / 2
                ZIndex: =2

        "MonthDayGallery As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver4.0'":
            Height: =373
            Items: =[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19, 20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41]
            Layout: =Layout.Vertical
            OnSelect: =
            ShowScrollbar: =false
            TemplatePadding: =0
            TemplateSize: =60
            Visible: =varCalendarVis
            Width: =420
            WrapCount: =7
            X: =106
            Y: =167
            ZIndex: =6

            MDG_HTML As htmlViewer:
                Height: =60
                HtmlText: |-
                    ="<div
                        style='
                            margin:7px 7px;
                            width: 35px;
                            height:35px;
                            background: #e8eaec;
                            box-shadow: inset 4px 4px 3px #bec0c2,inset -4px -4px 3px #ffffff;
                            border-radius:10px'>
                            "&If(
                                And(
                                    DateAdd(
                                        _firstDayInView,
                                        ThisItem.Value
                                    )
                                    =_dateSelected,
                                    MDG_Label.Visible
                                ),
                                "<div
                                    style='
                                        position:absolute;
                                        transform:translate(8px, 28px);
                                        width: 20px;
                                        height:3px;
                                        background:linear-gradient(to right, "&'Date Picker'.IconLinealGradient1&", "&'Date Picker'.IconLinealGradient2&") ;
                                        box-shadow: "&'Date Picker'.IconLinealGradient2&"  0px 2px 9px,inset -3px -3px 7px "&'Date Picker'.IconLinealGradient2&" ;
                                        border-radius: 90px'
                                </div>",
                                ""
                            )&"
                    </div>"
                OnSelect: =Select(Parent)
                Visible: |-
                    =/*This item is in a row containing no days of the visible month. It is in the row after the row where the last day of the month occurs*/ 
                     !(DateAdd(_firstDayInView,ThisItem.Value,TimeUnit.Days) - Weekday(DateAdd(_firstDayInView,ThisItem.Value,TimeUnit.Days)) + 1 > _lastDayOfMonth)
                Width: =60
                ZIndex: =1

            MDG_quadrangular2 As rectangle:
                Fill: =RGBA(186, 202, 226, 1)
                Height: =Self.Width
                OnSelect: =Select(Parent)
                Visible: =false
                Width: =6.5
                X: =Parent.TemplateWidth / 2 - Self.Width / 2
                Y: =Parent.TemplateHeight * (0.75)
                ZIndex: =2

            MDG_quadrangular As rectangle:
                Fill: =RGBA(56, 96, 178, 1)
                Height: =3 * MDG_Label.Size
                OnSelect: =Select(Parent)
                Visible: =false
                Width: =Self.Height
                X: =Parent.TemplateWidth/2 - Self.Width/2
                Y: =Parent.TemplateHeight / 2 - Self.Height / 2
                ZIndex: =3

            MDG_Label As label:
                Align: =Align.Center
                BorderColor: =RGBA(0, 0, 0, 0)
                Color: |-
                    =If(
                        DateAdd(
                            _firstDayInView,
                            ThisItem.Value
                        )= _dateSelected,
                        RGBA(96,96,96,1),
                        DateAdd(
                            _firstDayInView,
                            ThisItem.Value
                        ) = Today(),
                        RGBA(96,96,96,1),
                        CurrentDayLabel.Color
                    )
                Fill: |-
                    =/*Fill value changes if the gallery item day = today, or if it lies outside of the current month*/             
                    If(
                        /*Date selected is today*/
                        DateAdd(_firstDayInView, ThisItem.Value) = Today() && DateAdd(_firstDayInView, ThisItem.Value) = _dateSelected, RGBA(0,0,0,0),
                        /*Today when it is not selected*/
                        DateAdd(_firstDayInView, ThisItem.Value) = Today(), Color.Transparent, 
                        /*The day is outside the range of the currently selected month*/
                        Abs(Self.Text - ThisItem.Value) > 10,RGBA(200, 200, 200, 0.3), RGBA(0, 0, 0, 0))
                FocusedBorderColor: =Self.Color
                FocusedBorderThickness: =2
                Font: =Font.'Segoe UI'
                FontWeight: =FontWeight.Normal
                Height: =Parent.TemplateHeight
                OnSelect: =Set(_dateSelected, DateAdd(_firstDayInView, ThisItem.Value, TimeUnit.Days))
                Size: =17 * Parent.TemplateWidth / 91
                TabIndex: =0
                Text: =Day(DateAdd(_firstDayInView,ThisItem.Value,TimeUnit.Days))
                Visible: |-
                    =/*This item is in a row containing no days of the visible month. It is in the row after the row where the last day of the month occurs*/ 
                     !(DateAdd(_firstDayInView,ThisItem.Value,TimeUnit.Days) - Weekday(DateAdd(_firstDayInView,ThisItem.Value,TimeUnit.Days)) + 1 > _lastDayOfMonth)
                Width: =Parent.TemplateWidth
                Wrap: =false
                ZIndex: =4

            MDG_Button As button:
                Fill: =RGBA(0, 0, 0, 0)
                Height: =60
                HoverFill: =RGBA(196, 196, 196, 0.2)
                OnSelect: =Set(_dateSelected, DateAdd(_firstDayInView, ThisItem.Value, TimeUnit.Days)); Set(varCalendarVis, !varCalendarVis)
                PressedFill: =RGBA(196, 196, 196, 0.4)
                Text: =""
                Visible: =If(MDG_Label.Fill = RGBA(200, 200, 200, 0.3), false, true)
                Width: =60
                ZIndex: =5

